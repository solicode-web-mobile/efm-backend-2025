# ðŸ§ª **ContrÃ´le Laravel â€“ Jour 2 : Catalogue de produits avec alertes dynamiques**

## ðŸ§© **Contexte gÃ©nÃ©ral**

Tu dois dÃ©velopper un **module Laravel autonome et modulaire** nommÃ© `PkgProduit`, placÃ© dans le dossier `modules/`.

Ce module permet de :
- GÃ©rer un **catalogue de produits** (nom, prix, stock)
- Enregistrer des **rÃ¨gles mÃ©tier dynamiques** (stockÃ©es en base sous forme d'expressions)
- Ã‰valuer ces rÃ¨gles **dynamiquement via une classe `RuleEngine`**
- Afficher uniquement les **produits en alerte**, dans un **widget de tableau de bord**

---

## ðŸ› ï¸ **Contrainte technique obligatoire**

Le projet doit Ãªtre dÃ©veloppÃ© en **architecture modulaire Laravel**, avec l'arborescence suivante :

```
modules/
â””â”€â”€ PkgProduit/
    â”œâ”€â”€ Controllers/
    â”œâ”€â”€ Models/
    â”œâ”€â”€ Views/
    â”œâ”€â”€ App/
    â”‚   â”œâ”€â”€ Services/
    â”‚   â””â”€â”€ Requests/
    â””â”€â”€ lang/
```

Le module doit Ãªtre **dÃ©clarÃ© via un Service Provider personnalisÃ©**.  
Aucune logique mÃ©tier ne doit sortir du module.

---

## â—ï¸**Condition dâ€™accÃ¨s Ã  la suite du contrÃ´le**

- Si tu obtiens **au moins 4/5** au Dossier 1, tu continues.
- Sinon, tu redÃ©marres avec un **autre sujet**. La note obtenue est conservÃ©e (sur 5), les autres parties seront notÃ©es sur 35.

---

## ðŸ§¾ ModÃ¨le logique de donnÃ©es (MLD)

| Table        | Champs                                        |
|--------------|-----------------------------------------------|
| **produits** | id, nom, stock, prix, created_at, updated_at  |
| **rules**    | id, label, expression (type `text`)           |

---

# ðŸ“ **Dossier 1 â€“ Prototype : moteur de rÃ¨gles dynamiques**
ðŸ“– *Documentation autorisÃ©e*  
### ðŸ§® Note maximale : 5 points  
### â±ï¸ DurÃ©e : 30 minutes

### ðŸŽ¯ Objectif :
ImplÃ©menter une classe `RuleEngine` capable dâ€™Ã©valuer dynamiquement une rÃ¨gle mÃ©tier (exprimÃ©e en texte) sur un produit.

### ðŸ”¹ Questions Ã  traiter :

#### Q1.1 â€“ CrÃ©er une classe `RuleEngine` avec une mÃ©thode `evaluate(string $expression, array $data): bool`  
**(2 pts)**

#### Q1.2 â€“ Simuler un produit (ex : `['stock' => 2, 'prix' => 150]`) et appliquer une rÃ¨gle (ex : `stock < 5 && prix > 100`), puis afficher le rÃ©sultat dans une vue simple  
**(3 pts)**

---

# ðŸ“ **Dossier 2 â€“ CrÃ©ation + affichage paginÃ© des produits**
### ðŸ§® Note maximale : 10 points  
### â±ï¸ DurÃ©e : 1 heure

### ðŸŽ¯ Objectif :
Permettre Ã  lâ€™utilisateur dâ€™ajouter des produits via un **formulaire modal AJAX** et dâ€™afficher les produits enregistrÃ©s avec **pagination**.

### ðŸ”¹ Questions Ã  traiter :

#### Q2.1 â€“ CrÃ©er le modÃ¨le `Produit`, la migration, et le contrÃ´leur dans le module  
**(2 pts)**

#### Q2.2 â€“ CrÃ©er une vue avec un bouton â€œAjouter un produitâ€ â†’ ouverture dâ€™un modal contenant le formulaire  
**(2 pts)**

#### Q2.3 â€“ Envoyer le formulaire en AJAX + affichage des erreurs (validation) dans le modal  
**(3 pts)**

#### Q2.4 â€“ Afficher les produits dans une **table paginÃ©e (10 produits par page)**, triÃ©s par date de crÃ©ation dÃ©croissante  
**(3 pts)**

---

# ðŸ“ **Dossier 3 â€“ Tableau de bord avec widget dâ€™alertes dynamiques**
### ðŸ§® Note maximale : 25 points  
### â±ï¸ DurÃ©e : 1h30

### ðŸŽ¯ Objectif :
CrÃ©er un **tableau de bord responsive** contenant un **widget** qui affiche uniquement les **produits en alerte**, câ€™est-Ã -dire ceux qui valident **au moins une rÃ¨gle mÃ©tier**.

### ðŸ”¹ Questions Ã  traiter :

#### Q3.1 â€“ CrÃ©er la table `rules` avec migration et modÃ¨le, et y insÃ©rer **au moins deux rÃ¨gles** (avec un `label` explicite)  
**(3 pts)**

#### Q3.2 â€“ ImplÃ©menter un service `AlertService` avec une mÃ©thode publique :  
```php
public function getProduitsEnAlerte(): Collection
```  
Cette mÃ©thode doit :
- RÃ©cupÃ©rer tous les produits
- RÃ©cupÃ©rer toutes les rÃ¨gles
- Appliquer dynamiquement chaque rÃ¨gle Ã  chaque produit via `RuleEngine`
- Retourner uniquement les produits pour lesquels **au moins une rÃ¨gle retourne true**  
**(6 pts)**

#### Q3.3 â€“ CrÃ©er une vue `dashboard.blade.php` contenant un **widget** (carte visuelle ou bloc stylisÃ©) affichant la liste des produits en alerte  
**(7 pts)**

#### Q3.4 â€“ GÃ©rer toutes les erreurs dâ€™Ã©valuation (`RuleEngine`) :  
- Expression invalide (ex : `stock => 5`)
- Variable manquante (`prix`, `stock`, etc.)
- RÃ©sultat non boolÃ©en  
Affichage dâ€™un message propre sans casser lâ€™interface  
**(7 pts)**

#### Q3.5 â€“ Lâ€™interface du tableau de bord doit Ãªtre **responsive et fonctionnelle sur PC et mobile** (Bootstrap recommandÃ©)  
**(2 pts)**

---

## âœ… **RÃ©sumÃ© des barÃ¨mes**

| Dossier        | Description                                        | Note |
|----------------|----------------------------------------------------|------|
| Dossier 1      | Prototype â€“ moteur de rÃ¨gles dynamiques            | /5   |
| Dossier 2      | CrÃ©ation (AJAX + modal) + affichage paginÃ©         | /10  |
| Dossier 3      | Tableau de bord avec widget dâ€™alertes dynamiques   | /25  |
| **Total**      |                                                    | **/40** |

---

Souhaites-tu maintenant que je tâ€™envoie la version **PDF ou Word formatÃ©e**, ou veux-tu que je tâ€™aide Ã  crÃ©er le **starter Laravel** (structure, RuleEngine de base, migrations) ?